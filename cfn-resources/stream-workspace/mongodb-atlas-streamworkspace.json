{
  "typeName": "MongoDB::Atlas::StreamWorkspace",
  "description": "Returns, adds, updates, and removes Atlas Stream Processing Workspaces. The DataProcessRegion.Region property can be updated after creation. Other properties (WorkspaceName, ProjectId, Profile, StreamConfig, DataProcessRegion.CloudProvider) are create-only and require resource replacement to change.",
  "sourceUrl": "https://github.com/mongodb/mongodbatlas-cloudformation-resources.git",
  "definitions": {
    "BaseStreamsRegion": {
      "type": "string",
      "description": "Name of the cloud provider region hosting Atlas Stream Processing."
    },
    "StreamsDataProcessRegion": {
      "type": "object",
      "description": "Information about the cloud provider region in which MongoDB Cloud processes the stream.",
      "properties": {
        "CloudProvider": {
          "type": "string",
          "description": "Label that identifies the cloud service provider where MongoDB Cloud performs stream processing. For CloudFormation, this is restricted to AWS only.",
          "enum": ["AWS"],
          "default": "AWS"
        },
        "Region": {
          "$ref": "#/definitions/BaseStreamsRegion"
        }
      },
      "required": ["CloudProvider", "Region"],
      "additionalProperties": false
    },
    "StreamConfig": {
      "type": "object",
      "description": "Configuration options for an Atlas Stream Processing Workspace.",
      "properties": {
        "Tier": {
          "type": "string",
          "description": "Selected tier for the Stream Workspace. Configures Memory / VCPU allowances.",
          "title": "Stream Workspace Tier",
          "enum": ["SP2", "SP5", "SP10", "SP30", "SP50"]
        },
        "MaxTierSize": {
          "type": "string",
          "description": "Max tier size for the Stream Workspace. Configures Memory / VCPU allowances.",
          "title": "Stream Workspace Max Tier Size",
          "enum": ["SP2", "SP5", "SP10", "SP30", "SP50"]
        }
      },
      "required": ["Tier"],
      "additionalProperties": false
    },
    "StreamsKafkaAuthentication": {
      "type": "object",
      "description": "User credentials required to connect to a Kafka Cluster. Includes the authentication type, as well as the parameters for that authentication mode.",
      "properties": {
        "Mechanism": {
          "type": "string",
          "description": "Style of authentication. Can be one of PLAIN, SCRAM-256, or SCRAM-512."
        },
        "Username": {
          "type": "string",
          "description": "Username of the account to connect to the Kafka cluster."
        }
      },
      "additionalProperties": false
    },
    "DBRoleToExecute": {
      "type": "object",
      "description": "The name of a Built in or Custom DB Role to connect to an Atlas Cluster.",
      "properties": {
        "Role": {
          "type": "string",
          "description": "The name of the role to use. Can be a built in role or a custom role."
        },
        "Type": {
          "type": "string",
          "description": "Type of the DB role. Can be either BuiltIn or Custom.",
          "enum": ["BUILT_IN", "CUSTOM"]
        }
      },
      "additionalProperties": false
    },
    "StreamsKafkaSecurity": {
      "type": "object",
      "description": "Properties for the secure transport connection to Kafka. For SSL, this can include the trusted certificate to use.",
      "properties": {
        "BrokerPublicCertificate": {
          "type": "string",
          "description": "A trusted, public x509 certificate for connecting to Kafka over SSL."
        },
        "Protocol": {
          "type": "string",
          "description": "Describes the transport type. Can be either PLAINTEXT or SSL."
        }
      },
      "additionalProperties": false
    },
    "StreamsConnection": {
      "type": "object",
      "description": "Settings that define a connection to an external data store.",
      "properties": {
        "Name": {
          "type": "string",
          "description": "Human-readable label that identifies the stream connection."
        },
        "Type": {
          "type": "string",
          "description": "Type of the connection. Can be either Cluster or Kafka.",
          "enum": ["Kafka", "Cluster", "Sample"]
        },
        "Authentication": {
          "$ref": "#/definitions/StreamsKafkaAuthentication"
        },
        "BootstrapServers": {
          "type": "string",
          "description": "Comma separated list of server addresses."
        },
        "Security": {
          "$ref": "#/definitions/StreamsKafkaSecurity"
        },
        "ClusterName": {
          "type": "string",
          "description": "Name of the cluster configured for this connection."
        },
        "DbRoleToExecute": {
          "$ref": "#/definitions/DBRoleToExecute"
        }
      },
      "additionalProperties": false
    }
  },
  "properties": {
    "Profile": {
      "type": "string",
      "description": "The profile is defined in AWS Secret manager. See [Secret Manager Profile setup](../../../examples/profile-secret.yaml).",
      "default": "default"
    },
    "WorkspaceName": {
      "description": "Human-readable label that identifies the stream workspace.",
      "type": "string"
    },
    "DataProcessRegion": {
      "$ref": "#/definitions/StreamsDataProcessRegion"
    },
    "StreamConfig": {
      "$ref": "#/definitions/StreamConfig"
    },
    "Id": {
      "description": "Unique 24-hexadecimal character string that identifies the stream workspace.",
      "type": "string"
    },
    "Connections": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/StreamsConnection"
      },
      "insertionOrder": false
    },
    "ProjectId": {
      "description": "Unique 24-hexadecimal character string that identifies the project.",
      "type": "string"
    },
    "Hostnames": {
      "description": "List that contains the hostnames assigned to the stream workspace.",
      "type": "array",
      "items": {
        "type": "string"
      },
      "insertionOrder": false
    }
  },
  "additionalProperties": false,
  "required": ["ProjectId", "WorkspaceName", "DataProcessRegion"],
  "readOnlyProperties": [
    "/properties/Id",
    "/properties/Connections",
    "/properties/Hostnames"
  ],
  "primaryIdentifier": [
    "/properties/WorkspaceName",
    "/properties/ProjectId",
    "/properties/Profile"
  ],
  "createOnlyProperties": [
    "/properties/WorkspaceName",
    "/properties/ProjectId",
    "/properties/Profile",
    "/properties/StreamConfig"
  ],
  "handlers": {
    "create": {
      "permissions": ["secretsmanager:GetSecretValue"]
    },
    "read": {
      "permissions": ["secretsmanager:GetSecretValue"]
    },
    "update": {
      "permissions": ["secretsmanager:GetSecretValue"]
    },
    "delete": {
      "permissions": ["secretsmanager:GetSecretValue"]
    },
    "list": {
      "permissions": ["secretsmanager:GetSecretValue"]
    }
  },
  "documentationUrl": "https://github.com/mongodb/mongodbatlas-cloudformation-resources/blob/master/cfn-resources/stream-workspace/README.md",
  "tagging": {
    "taggable": false
  }
}
