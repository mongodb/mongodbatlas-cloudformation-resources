{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "This template generates one X.509 certificate for the specified MongoDB user. Atlas manages the certificate and MongoDB user that belong to one project. To use this resource, the requesting API Key must have the Project Atlas Admin role, this will be billed to your Atlas account.",
  "Parameters" : {
    "CustomerX509" : {
      "Type" : "String",
      "Description" : "",
	  "Default" : "",
      "ConstraintDescription" : ""
    },
    "ProjectName": {
      "Type": "String",
      "Default" : ""
    },
    "UserName" : {
      "Type" : "String",
      "Description" : "",
      "Default" : "",
      "ConstraintDescription" : ""
    },
    "MonthsUntilExpiration": {
      "Type": "String",
      "Description": "",
      "Default" : 0,
      "ConstraintDescription": ""
    }
  },
  "Mappings" : {},
  "Resources" : {
    "X509AuthenticationDatabaseUser": {
      "Type": "MongoDB::Atlas::X509AuthenticationDatabaseUser",
      "Properties": {
        "ProjectId": { "Ref" : "ProjectName" },
        "ApiKeys": {
          "PublicKey": "{{resolve:secretsmanager:mongodb/atlas/secrets:SecretString:AtlasMongoDBPublicKey}}",
          "PrivateKey": "{{resolve:secretsmanager:mongodb/atlas/secrets:SecretString:AtlasMongoDBPrivateKey}}"
        },
        "MonthsUntilExpiration": 0,
        "UserName":  { "Ref" : "UserName" },

        "CustomerX509":{
          "Cas": "-----BEGIN CERTIFICATE-----\nMIIFBzCCAu+gAwIBAgIIKfIY+m6eeLkwDQYJKoZIhvcNAQELBQAwSTEhMB8GA1UE\nAxMYNjMzYmY5N2E1Njg0NDY2YTQ3OTNjNTVjMQ4wDAYDVQQLEwVBdGxhczEUMBIG\nA1UEChMLTW9uZ29EQiBJbmMwHhcNMjIxMTAyMDczNjM1WhcNMjMwMjAyMDgzNjM1\nWjASMRAwDgYDVQQDEwd0ZXN0MTIzMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIIC\nCgKCAgEAgUPs2QazqUvKvdQqxk15VcpCiqAWvs799aLCYHCvEdUDpORZojnqzuNh\njYlIViJME7SidqZ7Oev1rVFsvPzTsREwQIrwDDE28H50aPwQG08sN/3mByqp11CR\nCK42LjBUR0yClRffe6D3FH3TmWmDVXg8qYq/BU+CHbKKeWM5fXFjAxV5ZV9Ezi3R\nYM59LVwsmKlgMYl7r+lS/7sgPrSlUxzeORJKvj3eE971U9CHc+Z9O+7YiJraVzHs\nid5oVei5Ce0TLB+iO6hVJFAq4ee1WWruy4CfD4svAk60IsWFiE/Tht7wW6opjeIV\nkImZS0TDVAdFiBcAHKmrdzpiosg2Z+NJOn9SbF/Xsn6aIOqZHCA0YW6AMBiYuoCU\n9pDINWToOCfnqzx0XeCQr8vGYZjj1AFOXnUdXQ4Q8t/77nZHo/B1dLmG2rbTGomL\nRQ/r7YNCGWTJoRnjH8YdEZ+ReNCS7mylFOseo5Slw12SO1fsSk96qha7pEIa2QmS\n/P6VKfvBikbg24SWYa7whEdvD87cOy/PZ5/V0imEyTQgPYfE04cO2ImdDd7XeM8W\n/P8bQUkiCftRLOONa+V2wAyp52vAEAiPEqy2tIvzWq7d4dT9Up4lNlxsEBD8/12I\nXqiEfpAeXaXEJOICTkIfqARixYjM+nNqe0wO5ioTxSo93r1ymSECAwEAAaMqMCgw\nDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMA0GCSqGSIb3\nDQEBCwUAA4ICAQAe2MbVh47d/juS+ru0Eaw6KXvcuoM4fJI7zOW47NxlHrfJeYUS\nS5K1WGEKV92ZtpayzXCSQU+IFW1z7Tx7buzvdg6Wtlbtol+2s2VP6RoXTPy7dMmI\n+hCGruI3oF2dlUT9n0ZYhK5HoKElSqrgFb/+DNTCAsct6G300Pj3pFw8XdZdAWHV\nZkEPbkV9u06sFRUsyZlDW2T5jdrrAqIowy0cvT1/LAAYcWwnWu+301Q73T31c9ev\naF/4BPdNheThDD27GXUkEpn5JJNhtMg7k20S6qWMl3Ao7Egn3PXtSmgVuzw12j0D\nRaqiMFx03gSQCFdLz0aoBgBonEDvnxTK66ElfEe2N/9X0O1Q6+UUbubcdtVccj24\nf0+Wqv6572DzQ9GUY/xXgmqxhfpoqV/rZ/xmq05WzbebeML9BxjYsHzdTTBB1v5a\n8f9SCiW4uZCI//8ajP5yBrXKla8hE7/sZ9d+EGJ/ITWAxnjspN1wto8YzRZdi1mQ\ncBYTyopsKL/vFq2sd4vvzVAxwa1tjw94LY0zoli05DV+4sEGFUpZBAThU48y7TYI\nJIrFBisPeQHAf73Pwf7zb3V6aVFFL8wKR5FgyPXBRLPCOGoN+bOFajSwFxdGSDGM\nE3NH9Vy9sNqGvA8UfIZ+O146t1lsJRIJUQEt1KUxnZrzk7CQbUHgOtvflg==\n-----END CERTIFICATE-----\n-----BEGIN PRIVATE KEY-----\nMIIJQgIBADANBgkqhkiG9w0BAQEFAASCCSwwggkoAgEAAoICAQCBQ+zZBrOpS8q9\n1CrGTXlVykKKoBa+zv31osJgcK8R1QOk5FmiOerO42GNiUhWIkwTtKJ2pns56/Wt\nUWy8/NOxETBAivAMMTbwfnRo/BAbTyw3/eYHKqnXUJEIrjYuMFRHTIKVF997oPcU\nfdOZaYNVeDypir8FT4Idsop5Yzl9cWMDFXllX0TOLdFgzn0tXCyYqWAxiXuv6VL/\nuyA+tKVTHN45Ekq+Pd4T3vVT0Idz5n077tiImtpXMeyJ3mhV6LkJ7RMsH6I7qFUk\nUCrh57VZau7LgJ8Piy8CTrQixYWIT9OG3vBbqimN4hWQiZlLRMNUB0WIFwAcqat3\nOmKiyDZn40k6f1JsX9eyfpog6pkcIDRhboAwGJi6gJT2kMg1ZOg4J+erPHRd4JCv\ny8ZhmOPUAU5edR1dDhDy3/vudkej8HV0uYbattMaiYtFD+vtg0IZZMmhGeMfxh0R\nn5F40JLubKUU6x6jlKXDXZI7V+xKT3qqFrukQhrZCZL8/pUp+8GKRuDbhJZhrvCE\nR28Pztw7L89nn9XSKYTJNCA9h8TThw7YiZ0N3td4zxb8/xtBSSIJ+1Es441r5XbA\nDKnna8AQCI8SrLa0i/Nart3h1P1SniU2XGwQEPz/XYheqIR+kB5dpcQk4gJOQh+o\nBGLFiMz6c2p7TA7mKhPFKj3evXKZIQIDAQABAoICAF7q/LDD/grTT5UihSJF41G+\niiv2r5z+q3bCQ87DD5qdeuaKktLPin7OcmSWqNoupwRVQHK1foiinizdPGZtlBhS\nEcdi/i9FuBzSDjLE3CLheQvIUS90AXDMhSMFoV07Obd9E+nctMq4AJY4arccxkZt\nWsX3zppcrqOV5Z6K4L0fFGBAVXq9gO2QsU1PcpVrOIgE31CgroUWZE7KHjxNM5Sa\n/waTSvT0wux+bFBWMBBH8C+hC7kLVEZwr0rxWFW05KLIRarBs8PwsExQ3ZwyI3T8\nU0p1MNceEa+1EQrzVUEptJ41d/MnOQopOEKA92JQpMk/6aurj/Z8FB8hbSowr9l/\n4QJUarsRy8JZkYm/3qvqNI+57xO2VkmctmBXxCKUAxhd/6DAutJwONFqFTqHGeP+\nSpS0P7uS9ZsTWhyHBrouzn25Yn3m3G8nIhzPLVoyRa4+++ozs4dtxLsULsYzWjJn\nrvrSZAnI28RXwgbSwyUj7QltAcBoMcSp2g3bkBTF9B2z2Hb0ojz9cX2BJUh/xeVw\ncop4HCBb4B+QN9ftDTaqCRLKiKiadSP/Z4LW5dRGqDSKRhJqoSd1OKQO5pN7Lpyh\no1xBsQ7bm3/RH1U+M7szi8MfAcH4qlRJTr91gqRxJ7Bh1LFsOzkKELr4rO5TCTTv\nOVfaTPvlU9Ns6gc7OhodAoIBAQC2LrYACE7ntfMCGlF4VITOBXVGVfl5AnwdMexx\nK0TRX8VrWu8EcGy/+xEAnZ+HSp+44Wcp59iEYZ38WeQVcmbImsifFycoRofl6EAF\nqg+avpiu3lr5PboK1X3+WxRLhFvtdbbQaDxN+LUbzxnV9ooY5XwL9T4G5bS1hPS1\nbauz9Zm7eDbdyBFoBx7PBI8JWoISiEWeUy2y+s52K30L91c20/p2cI1JcfrcrV+X\nxruRX7K0TADH+wQdJtpUvEXC6DG3c4+cUZMQ1tAyumbaXsX5wPxuffbxFUEco7MR\neE/LJ+p0ldJPdRyfWfVA0oMTn1A2czKJnTwe/GN74MFawxyzAoIBAQC1pEPKmwO5\ndA8YCuh//u+iURYCedG7qLFUveZWTAqNNwXXe8GNdRdP1ockiZQnE8JOrbZMb4I8\nbQgvRHpv4YwtUF4rmLb7GIi5v9eWRV7awJSxddRz7smMggfGdjjCW+qr59zgTY0Z\nhlZ8KPJnH0r7idYczXIcRyUAKiSpv+7QMGYRT2GG7eH4KAJw1M2dQtZ40yBlWOmF\n/Xp+KlTGsrEYGmm0BJfYlJBH8gFhQxwqwgVMW6E2PemAW3dZBXpIzmEKtj8nB1jK\np7O8Y5+XddHRbaTYk9KrEoZD+9rSgV7jHTN9wfV5B40INwH7lfe3UhroOhlpKLQX\nMJfLZBPXMMTbAoIBAAZw3lRf9tIwV5gScCDt9AgIn13OOlSx5sttcWuK2RMB7Mvf\n2iVxCBc9fBtmdzZkSANUTL5piPkdLmW2k97CPaoH9uHRArxkyfcx39mTapvQ8zrz\nd4nqScKKS7sLY0tMMafSipURqlgjW9vQ1Zv/7F/29QzDLd82jc4BFlm3t+NT4oyD\nMoVixmLEJa2x/pCZF5IqKTPwwuPaBCSfYvtiUj4I/ojjb8tR8UmOA5wtFYKNPJct\nPLXVRQ72ya9HPLwoU2Gl/0TKiYWF4rR4bJx5z0wGK6aIY4ugcb3ed709YKzRC3P1\nvAq9HDbyCj6xcprl/gL+zaGZ4n9B8w51IsDftwsCggEAQ8EYQHT+OKkgEDnRbB0u\nSf+xFA9YuoU8UH3dc4c90Fsb5LsXAasRnQhKtMhU6Ranvi1x+KUHkX6iNO94NE+P\nuD9oQR7f8l2+cnsq8bTCoxp+3Is1SmFh8PV37QGgPm+G48TDUS/cWA8SJ5ImiWzU\nzWsm4OuJix7GoH8X2fHsJOBI0mAn4urNBYH3Fxtp7yVFVyB5zxQRV5ern3Au20dA\nY9tGXo3wDiusfgm5lgwwb4qb61Wqls8VUHnN1PkEGjBRZmuAtxA4gK95jeYjW53p\nPBOID/lj9cgdKTLC9w6m1FTKJji5VgIJC21pYe0Yz9riiolRfTZfpt7LYGTeOcDJ\nTQKCAQEAqMQUNvHnGuqHKLuN1qpv2GrITzW01HeFACieIru7Y4P+4LSY5G6Dn7h1\nxKnnywx2zlv8Ujzd7/l0SnN+jn2s6pKu4/L0lgeeySzycpbZ50e0n5Hob8M3ZFtP\nI9k8O7G/5MWBhdvfC/+ANS5rje9Xf7R27E80BgQD7XKd9LPyum2IhG8ucWLlDoV1\nmo0kwrmsuod+pGFC0/xF1kPuQFdJL9VdKF3WWjX/zM31vgpSHL9r0mplEIwc9Oss\nnzW7DWiZQ47C4jmlbYfHplOmHvTWcLh8B9oYTJYVsfjCtBioSUmyWtblpqUMVYzE\n83YyEnJFdIu/9rUw3I3C9uIlXxSxlQ==\n-----END PRIVATE KEY-----\n"
        }

      }
    }
  },
  "Outputs" : {}
}
